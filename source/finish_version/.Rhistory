group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
library(ggplot2)
library(tidyr)
library(dplyr)
set.seed(2018)1
synth.data <- data.frame(x1 =c(rnorm(20, 3, 1), rnorm(20,0,1), rnorm(20,5,1)),
x2 =c(rnorm(20, 0, 1), rnorm(20,4,1), rnorm(20,5,1)))
synth.data
ndata <- nrow(synth.data)
ndim <- ncol(synth.data)
synth.data %>%
ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
synth.data$cl <- factor(rep(1, ndata), levels =1:k)
synth.data %>% ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()# +
#geom_point(data =cents, shape =4, col ='red')
############################ Questions ###############################
# set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
library(ggplot2)
library(tidyr)
library(dplyr)
set.seed(2018)1
synth.data <- data.frame(x1 =c(rnorm(20, 3, 1), rnorm(20,0,1), rnorm(20,5,1)),
x2 =c(rnorm(20, 0, 1), rnorm(20,4,1), rnorm(20,5,1)))
synth.data
ndata <- nrow(synth.data)
ndim <- ncol(synth.data)
synth.data %>%
ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
synth.data$cl <- factor(rep(1, ndata), levels =1:k)
synth.data %>% ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()# +
#geom_point(data =cents, shape =4, col ='red')
############################ Questions ###############################
# set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
library(ggplot2)
library(tidyr)
library(dplyr)
set.seed(2018)
synth.data <- data.frame(x1 =c(rnorm(20, 3, 1), rnorm(20,0,1), rnorm(20,5,1)),
x2 =c(rnorm(20, 0, 1), rnorm(20,4,1), rnorm(20,5,1)))
synth.data
ndata <- nrow(synth.data)
ndim <- ncol(synth.data)
synth.data %>%
ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
synth.data$cl <- factor(rep(1, ndata), levels =1:k)
synth.data %>% ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()# +
#geom_point(data =cents, shape =4, col ='red')
############################ Questions ###############################
# set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
library(ggplot2)
library(tidyr)
library(dplyr)
set.seed(2018)
synth.data <- data.frame(x1 =c(rnorm(20, 3, 1), rnorm(20,0,1), rnorm(20,5,1)),
x2 =c(rnorm(20, 0, 1), rnorm(20,4,1), rnorm(20,5,1)))
synth.data
ndata <- nrow(synth.data)
ndim <- ncol(synth.data)
synth.data %>%
ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
synth.data$cl <- factor(rep(1, ndata), levels =1:k)
synth.data %>% ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()# +
#geom_point(data =cents, shape =4, col ='red')
############################ Questions ###############################
# set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
library(ggplot2)
library(tidyr)
library(dplyr)
set.seed(2018)
synth.data <- data.frame(x1 =c(rnorm(20, 3, 1), rnorm(20,0,1), rnorm(20,5,1)),
x2 =c(rnorm(20, 0, 1), rnorm(20,4,1), rnorm(20,5,1)))
synth.data
ndata <- nrow(synth.data)
ndim <- ncol(synth.data)
synth.data %>%
ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
synth.data$cl <- factor(rep(1, ndata), levels =1:k)
synth.data %>% ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()# +
#geom_point(data =cents, shape =4, col ='red')
############################ Questions ###############################
# set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
library(ggplot2)
library(tidyr)
library(dplyr)
set.seed(2018)
synth.data <- data.frame(x1 =c(rnorm(20, 3, 1), rnorm(20,0,1), rnorm(20,5,1)),
x2 =c(rnorm(20, 0, 1), rnorm(20,4,1), rnorm(20,5,1)))
synth.data
ndata <- nrow(synth.data)
ndim <- ncol(synth.data)
synth.data %>%
ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
synth.data$cl <- factor(rep(1, ndata), levels =1:k)
synth.data %>% ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()# +
#geom_point(data =cents, shape =4, col ='red')
############################ Questions ###############################
# set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
set.seed(NULL)
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
k1 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[1,2:3])})
k2 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[2,2:3])})
k3 <- apply(synth.data[,1:2], 1, function(x){u_dist(x, cents[3,2:3])})
a <- rbind(k1,k2)
a <- rbind(a,k3)
synth.data[,3] <- apply(a, 2, which.min)
as.factor(synth.data$cl)
cents <- synth.data %>%
group_by(cl) %>%
summarise(x1=mean(x1),
x2=mean(x2))
synth.data %>% ggplot(aes(x =x1, y=x2, col =as.factor(cl))) +
geom_point(shape =1) +
theme_bw() +
geom_point(data =cents, shape =4, col ='red')
set.seed(2018)
synth.data <- data.frame(x1 =c(rnorm(20, 3, 1), rnorm(20,0,1), rnorm(20,5,1)),
x2 =c(rnorm(20, 0, 1), rnorm(20,4,1), rnorm(20,5,1)))
synth.data
ndata <- nrow(synth.data)
ndim <- ncol(synth.data)
synth.data %>%
ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
k <-3
cents <-data.frame(cl =1:k)
cents <-cbind(cents, synth.data[sample(1:60, k),])
synth.data$cl <- factor(rep(1, ndata), levels =1:k)
synth.data %>% ggplot(aes(x =x1, y=x2)) +
geom_point(shape =1) +
theme_bw()# +
library(stringr)
library(dplyr)
src_dir <- c('/Users/osangjin/Desktop/past/Recommendation-system/data')
src_file <- list.files(src_dir)
file_name <- gsub(pattern=' ', replacement = '', paste(src_dir, '/', src_file[1]))
user_id <- as.numeric(str_extract(src_file[1], '\\d+'))
df <- read.csv(file_name)
df_name <- paste('df',user_id, sep='')
id_lst <- c()
id_lst[1] <- user_id
View(df)
df <- df[, -1]
assign(df_name, df)
src_file_cnt <- length(src_file)
src_file_cnt
id_lst <- c()
for(i in 1:src_file_cnt) {
file_name <- gsub(pattern=' ', replacement = '', paste(src_dir, '/', src_file[i]))
user_id <- as.numeric(str_extract(src_file[i], '\\d+'))
df <- read.csv(file_name)
df_name <- paste('df',user_id, sep='')
id_lst[i] <- user_id
df <- df[, -1]
assign(df_name, df)
}
list_df_data <- mget(ls(pattern = "^df\\d+"))
check_df <- function(df, i){
df_type <- class(df[[i]])
if (df_type[1] != "data.frame") {
df[[2]] <- as.data.frame(df[[2]])
df[[2]] <- t(df[[2]])
df[[2]][,2] <- as.numeric(df[[2]][,2])
}
return (df[[i]])
}
A <- list_df_data[[1]]
colnames(A) <- c("title", 1)
merge_df <- A
i = 2
repeat{
if(i>src_file_cnt-1) break
B <- check_df(list_df_data,i)
colnames(B) <- c("title", i)
merge_df <- merge(x=merge_df, y=B, by='title', all=TRUE)
i <- i+1
}
restaurant_lst <- as.vector(merge_df[,1])
restaurant_lst
user_item <- merge_df[,-1]
rownames(user_item) <- paste("i", 1:nrow(user_item), sep='')
colnames(user_item) <- paste("u", 1:ncol(user_item), sep='')
user_item <- user_item[which(rowSums(!is.na(user_item)) > 3),]
View(user_item)
setwd("~/Desktop/past/Recommendation-system/source/submit")
pearsonCor <- function(x, y){
x_mean <- mean(x, na.rm = T)
y_mean <- mean(y, na.rm = T)
idx <- !is.na(x) & !is.na(y)
if(sum(idx) == 0) return(NA)
x_new <- x[idx]
y_new <- y[idx]
sum((x_new- x_mean) * (y_new-y_mean)) /
sqrt( sum( (x_new - x_mean)**2) * sum( (y_new-y_mean) **2) )
}
u_dist<-function(u, v){
sqrt(sum((u -v) **2))
}
m <- matrix(sample(c(as.numeric(0:5), NA), 50,
replace=TRUE, prob=c(rep(.4/6,6),.6)), ncol=10,
dimnames=list(user=paste("u", 1:5, sep=""),
item=paste("i", 1:10, sep="")))
m
u <-m['u1',]
u
sim <- apply(m, 1, function(x) {
pearsonCor(u, x) })
sim
library(doBy)
k=2
k_neighbors <- setdiff(which.maxn(sim, k+1), 1)
k_neighbors
k_recommend <- apply(m[k_neighbors,], 2, function(x) { mean(x, na.rm = T)})
k_recommend
k_recommend_final <- k_recommend[is.na(u)]
sort(k_recommend_final, decreasing = T)
library(proxy)
user_item_t <- t(user_item)
user_similarity <- as.matrix(dist(user_item_t, method = "pearson")) # cosine, euclidean
item_similarity <- as.matrix(dist(user_item, method = "cosine"))
head(user_similarity)
head(item_similarity)
cat(\014)
cat("\014")
item_similarity <- as.matrix(dist(user_item, method = "euclidean"))
library(proxy)
user_item_t <- t(user_item)
user_similarity <- as.matrix(Dist(user_item_t, method = "pearson")) # cosine, euclidean
item_similarity <- as.matrix(Dist(user_item, method = "cosine"))
head(user_similarity)
head(item_similarity)
install.packages("Dist")
pearson.dist(user_item)
cor(user_item, y = NULL, use = "everything", method = c("pearson"))
cor(user_item, y = NULL, use = "everything", method = c("pearson"))
head(user_item)
cor(user_item, y = NULL, use =  "complete.obs", method = c("pearson"))   # x, y 두 columnuse = 결측치 처리 (NA포함이면 NA처리)
cor(user_item, y = NULL, use =  "pairwise.complete.obs", method = c("pearson"))   # x, y 두 columnuse = 결측치 처리 (NA포함이면 NA처리)
